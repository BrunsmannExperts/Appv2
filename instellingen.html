<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>Instellingen â€“ Brunsmann</title>
  <link rel="stylesheet" href="style.css">
  <script src="sidebar_loader.js"></script>
  <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
</head>
<body>
  <div id="sidebar-container"></div>
  <main>
    <h1>Instellingen</h1>
    <section class="card">
      <h2>Upload rapportonderdelen (Excel per hoofdstuk)</h2>
      <table>
        <thead>
          <tr>
            <th>Hoofdstuk</th>
            <th>Upload Excel</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>Motor</td><td><input type="file" accept=".xlsx" onchange="saveToLocalStorage(this, 'rapport_motor_excel')"></td></tr>
          <tr><td>Romp</td><td><input type="file" accept=".xlsx" onchange="saveToLocalStorage(this, 'rapport_romp_excel')"></td></tr>
          <tr><td>Elektrisch</td><td><input type="file" accept=".xlsx" onchange="saveToLocalStorage(this, 'rapport_elektra_excel')"></td></tr>
          <tr><td>Gasinstallatie</td><td><input type="file" accept=".xlsx" onchange="saveToLocalStorage(this, 'rapport_gas_excel')"></td></tr>
          <tr><td>Veiligheid</td><td><input type="file" accept=".xlsx" onchange="saveToLocalStorage(this, 'rapport_veiligheid_excel')"></td></tr>
        </tbody>
      </table>
    </section>
  </main>
  <script>
    function saveToLocalStorage(input, key) {
      const file = input.files[0];
      const reader = new FileReader();
      reader.onload = function (e) {
        localStorage.setItem(key, e.target.result);
        alert('Bestand opgeslagen in browser voor: ' + key);
      };
      reader.readAsDataURL(file);
    }
  </script>
</body>
</html>
